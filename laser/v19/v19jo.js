var _0x999f = ["selectReturn", "messaging", "messageFactory", "recvQueue", "state", "newOperator", "createMessageByType", "replace", "returnAddress", "equals", "pthreadReturn", "context", "exports", "libg.so", "findModuleByName", "findExportByName", "free", "void", "libc.so", "pthread_mutex_lock", "pointer", "int", "pthread_cond_signal", "memmove", "ntohs", "uint16", "inet_addr", "send", "recv", "use", "java.lang.System", "java.lang.Runtime", "overload", "java.lang.String", "dalvik.system.VMStack", "implementation", "getRuntime", "loadLibrary0", "getCallingClassLoader", "loadLibrary", "lib", ".so", "add", "readInt", "writeInt", "readPointer", "writePointer", "readU8", "writeU8", "sub", "attach", "readU16", "toInt32", "options", "redirectHost", "allocUtf8String", "length", "wakeUpReturnArray", "base", "sendQueue", "loginMessagePtr", "serverConnection"];
(function (_0x3e55b9, _0x2a09d5) {
    var _0x35ea98 = function (_0x30197b) {
        while (--_0x30197b) {
            _0x3e55b9.push(_0x3e55b9.shift());
        }
    };
    _0x35ea98(++_0x2a09d5);
}(_0x999f, 449));
var _0x1840 = function (_0x12a33c, _0x1e279a) {
    _0x12a33c = _0x12a33c - 0;
    var _0x28ee89 = _0x999f[_0x12a33c];
    return _0x28ee89;
};
var _0x59fc6b = { modules: {}, options: {} }, _0x11e329 = 10571028, _0x27aae2 = 6503925, _0x5c2e78 = [1158964, 969512, 3347260, 4151360, 4293332, 4539472], _0x3c6562 = 6318223, _0x4ed8c8 = 2762900, _0x5f4e4b = 5440352, _0x5ae793 = 4, _0x453cbe = new NativeFunction(Module[_0x1840("0x0")]("libc.so", _0x1840("0x1")), _0x1840("0x2"), ["pointer"]), _0x5ce9bc = new NativeFunction(Module[_0x1840("0x0")](_0x1840("0x3"), _0x1840("0x4")), "int", [_0x1840("0x5")]), _0x430670 = new NativeFunction(Module.findExportByName("libc.so", "pthread_mutex_unlock"), _0x1840("0x6"), ["pointer"]), _0x5f2777 = new NativeFunction(Module[_0x1840("0x0")](_0x1840("0x3"), _0x1840("0x7")), _0x1840("0x6"), [_0x1840("0x5")]), _0x2f71bc = new NativeFunction(Module[_0x1840("0x0")](_0x1840("0x3"), "select"), "int", [_0x1840("0x6"), _0x1840("0x5"), _0x1840("0x5"), _0x1840("0x5"), _0x1840("0x5")]), _0x135e19 = new NativeFunction(Module[_0x1840("0x0")](_0x1840("0x3"), _0x1840("0x8")), "pointer", [_0x1840("0x5"), _0x1840("0x5"), "int"]), _0x1be1c2 = new NativeFunction(Module.findExportByName(_0x1840("0x3"), _0x1840("0x9")), _0x1840("0xa"), [_0x1840("0xa")]), _0x343d9b = new NativeFunction(Module[_0x1840("0x0")](_0x1840("0x3"), _0x1840("0xb")), _0x1840("0x6"), [_0x1840("0x5")]), _0x3202ad = new NativeFunction(Module[_0x1840("0x0")]("libc.so", _0x1840("0xc")), _0x1840("0x6"), [_0x1840("0x6"), _0x1840("0x5"), "int", _0x1840("0x6")]), _0x5ebcc5 = new NativeFunction(Module[_0x1840("0x0")](_0x1840("0x3"), _0x1840("0xd")), "int", [_0x1840("0x6"), "pointer", _0x1840("0x6"), _0x1840("0x6")]);
function _0x4499be(_0xe69997, _0x1baad3) {
    Java.perform(function () {
        var _0x475406 = Java[_0x1840("0xe")](_0x1840("0xf")), _0x4da891 = Java[_0x1840("0xe")](_0x1840("0x10")), _0x3b255e = _0x475406.loadLibrary[_0x1840("0x11")](_0x1840("0x12")), _0x32fc6c = Java.use(_0x1840("0x13"));
        _0x3b255e[_0x1840("0x14")] = function (_0x475406) {
            try {
                _0x4da891[_0x1840("0x15")]().loadLibrary0 ? _0x4da891.getRuntime()[_0x1840("0x16")](_0x32fc6c[_0x1840("0x17")](), _0x475406) : _0x4da891.getRuntime()[_0x1840("0x18")](_0x475406, _0x32fc6c[_0x1840("0x17")]());
                _0xe69997 === _0x1840("0x19") + _0x475406 + _0x1840("0x1a") && _0x1baad3();
            } catch (_0xf0327a) { }
        };
    });
}
var _0x2759dd = {
    e: function (_0x2c22b8) {
        return _0x2c22b8[_0x1840("0x1b")](8);
    }, n: function (_0x399234) {
        return Memory[_0x1840("0x1c")](_0x399234[_0x1840("0x1b")](4));
    }, t: function (_0x102412, _0x23b408) {
        Memory[_0x1840("0x1d")](_0x102412[_0x1840("0x1b")](4), _0x23b408);
    }, o: function (_0x5462fc) {
        return new NativeFunction(Memory[_0x1840("0x1e")](Memory[_0x1840("0x1e")](_0x5462fc)[_0x1840("0x1b")](20)), _0x1840("0x6"), [_0x1840("0x5")])(_0x5462fc);
    }, c: function (_0xb5ad5c) {
        new NativeFunction(Memory.readPointer(Memory.readPointer(_0xb5ad5c).add(8)), _0x1840("0x2"), ["pointer"])(_0xb5ad5c);
    }, r: function (_0x4485fd) {
        new NativeFunction(Memory.readPointer(Memory.readPointer(_0x4485fd).add(12)), _0x1840("0x2"), [_0x1840("0x5")])(_0x4485fd);
    }, i: function (_0x4a3bce) {
        new NativeFunction(Memory[_0x1840("0x1e")](Memory[_0x1840("0x1e")](_0x4a3bce).add(24)), _0x1840("0x2"), ["pointer"])(_0x4a3bce);
        new NativeFunction(Memory[_0x1840("0x1e")](Memory[_0x1840("0x1e")](_0x4a3bce)[_0x1840("0x1b")](4)), _0x1840("0x2"), ["pointer"])(_0x4a3bce);
    }
}, _0x3212c3 = {
    a: function (_0x5b2bb1) {
        return Memory[_0x1840("0x1c")](_0x5b2bb1[_0x1840("0x1b")](16));
    }, u: function (_0x1a70f3) {
        return Memory[_0x1840("0x1e")](_0x1a70f3[_0x1840("0x1b")](28));
    }, s: function (_0x2c45eb, _0x351301) {
        Memory[_0x1840("0x1f")](_0x2c45eb.add(28), _0x351301);
    }, M: function (_0x315148) {
        return Memory.readInt(_0x315148.add(20));
    }, _: function (_0x2671b7, _0x43dbc1) {
        Memory[_0x1840("0x1d")](_0x2671b7[_0x1840("0x1b")](20), _0x43dbc1);
    }
}, _0x1c73a7 = {
    m: function (_0x1cc738) {
        return Memory[_0x1840("0x20")](_0x1cc738[_0x1840("0x1b")](2)) << 16 | Memory.readU8(_0x1cc738[_0x1840("0x1b")](3)) << 8 | Memory[_0x1840("0x20")](_0x1cc738[_0x1840("0x1b")](4));
    }, h: function (_0x2552a5, _0x406e91) {
        Memory.writeU8(_0x2552a5[_0x1840("0x1b")](2), _0x406e91 >> 16 & 255);
        Memory.writeU8(_0x2552a5[_0x1840("0x1b")](3), _0x406e91 >> 8 & 255);
        Memory.writeU8(_0x2552a5[_0x1840("0x1b")](4), 255 & _0x406e91);
    }, f: function (_0x4c40c2, _0x2a1398) {
        Memory[_0x1840("0x21")](_0x4c40c2.add(0), _0x2a1398 >> 8 & 255);
        Memory[_0x1840("0x21")](_0x4c40c2.add(1), 255 & _0x2a1398);
    }, y: function (_0x3dbd04) {
        return Memory[_0x1840("0x20")](_0x3dbd04[_0x1840("0x1b")](5)) << 8 | Memory[_0x1840("0x20")](_0x3dbd04[_0x1840("0x1b")](6));
    }, g: function (_0x1ca4c7, _0x276a20) {
        Memory[_0x1840("0x21")](_0x1ca4c7[_0x1840("0x1b")](5), _0x276a20 >> 8 & 255);
        Memory[_0x1840("0x21")](_0x1ca4c7[_0x1840("0x1b")](6), 255 & _0x276a20);
    }, o: function (_0x4553b8) {
        return Memory.readU8(_0x4553b8) << 8 | Memory[_0x1840("0x20")](_0x4553b8[_0x1840("0x1b")](1));
    }
}, _0x8878f = {
    l: function (_0x15ed3e) {
        return Memory[_0x1840("0x1c")](_0x15ed3e.add(4));
    }, d: function (_0x416e3f, _0x45f1d8) {
        return Memory[_0x1840("0x1e")](Memory[_0x1840("0x1e")](_0x416e3f).add(_0x5ae793 * _0x45f1d8));
    }, v: function (_0x5e62ed, _0x56059a, _0x52c254) {
        Memory[_0x1840("0x1f")](Memory[_0x1840("0x1e")](_0x5e62ed)[_0x1840("0x1b")](_0x5ae793 * _0x56059a), _0x52c254);
    }, p: function (_0x2fd6a1) {
        return Memory.readInt(_0x2fd6a1[_0x1840("0x1b")](8));
    }, N: function (_0x53542c) {
        Memory[_0x1840("0x1d")](_0x53542c[_0x1840("0x1b")](8), Memory[_0x1840("0x1c")](_0x53542c[_0x1840("0x1b")](8)) - 1);
    }, R: function (_0x21eb5b) {
        Memory.writeInt(_0x21eb5b[_0x1840("0x1b")](8), Memory[_0x1840("0x1c")](_0x21eb5b[_0x1840("0x1b")](8)) + 1);
    }, T: function (_0xcbc060) {
        return Memory[_0x1840("0x1c")](_0xcbc060[_0x1840("0x1b")](12));
    }, b: function (_0x4f8032) {
        return Memory[_0x1840("0x1c")](_0x4f8032.add(16));
    }, A: function (_0x3a0153, _0x597ee3) {
        Memory[_0x1840("0x1d")](_0x3a0153[_0x1840("0x1b")](12), _0x597ee3);
    }, S: function (_0x187231, _0x30b922) {
        Memory[_0x1840("0x1d")](_0x187231[_0x1840("0x1b")](16), _0x30b922);
    }, w: function (_0x1643ea, _0x35ad18) {
        _0x5ce9bc(_0x1643ea[_0x1840("0x22")](4));
        var _0x4a4e00 = _0x8878f.b(_0x1643ea);
        _0x8878f.v(_0x1643ea, _0x4a4e00, _0x35ad18);
        _0x8878f.S(_0x1643ea, (_0x4a4e00 + 1) % _0x8878f.l(_0x1643ea));
        _0x8878f.R(_0x1643ea);
        _0x430670(_0x1643ea[_0x1840("0x22")](4));
    }, B: function (_0x34d296) {
        var _0x311370 = null;
        if (_0x5ce9bc(_0x34d296[_0x1840("0x22")](4)), _0x8878f.p(_0x34d296)) {
            var _0x31adeb = _0x8878f.T(_0x34d296);
            _0x311370 = _0x8878f.d(_0x34d296, _0x31adeb);
            _0x8878f.A(_0x34d296, (_0x31adeb + 1) % _0x8878f.l(_0x34d296));
            _0x8878f.N(_0x34d296);
        }
        return _0x430670(_0x34d296[_0x1840("0x22")](4)), _0x311370;
    }
};
function _0x488c34() { // TODO: FIX REDIRECTOR
    Interceptor[_0x1840("0x23")](Module.findExportByName(_0x1840("0x3"), "connect"), {
        onEnter: function (_0x5a7111) {
            if (9339 === _0x1be1c2(Memory[_0x1840("0x24")](_0x5a7111[1][_0x1840("0x1b")](2)))) {
                if (_0x59fc6b.fd = _0x5a7111[0][_0x1840("0x25")](), _0x59fc6b[_0x1840("0x26")][_0x1840("0x27")]) {
                    var _0x33acb2 = Memory[_0x1840("0x28")](_0x59fc6b[_0x1840("0x26")][_0x1840("0x27")]);
                    Memory[_0x1840("0x1d")](_0x5a7111[1][_0x1840("0x1b")](4), _0x343d9b("127.0.0.1")); // IP Here
                }
                _0x3a939e();
            }
        }
    });
}
function _0x3a939e() {
    _0x59fc6b.wakeUpReturnArray = [];
    for (var _0x28e6f9 = 0; _0x28e6f9 < _0x5c2e78[_0x1840("0x29")]; _0x28e6f9 += 1) {
        _0x59fc6b[_0x1840("0x2a")].push(_0x59fc6b[_0x1840("0x2b")][_0x1840("0x1b")](_0x5c2e78[_0x28e6f9]));
    }
    function _0x7bc3ba() {
        for (var _0x28e6f9 = _0x8878f.B(_0x59fc6b[_0x1840("0x2c")]); _0x28e6f9;) {
            10100 === _0x2759dd.o(_0x28e6f9) && (_0x28e6f9 = Memory.readPointer(_0x59fc6b[_0x1840("0x2d")]), Memory[_0x1840("0x1f")](_0x59fc6b.loginMessagePtr, ptr(0)));
            _0x2759dd.c(_0x28e6f9);
            var _0x24b78c = _0x2759dd.e(_0x28e6f9), _0x5a3cf8 = _0x3212c3.a(_0x24b78c), _0x7bc3ba = _0x59fc6b.newOperator(_0x5a3cf8 + 7);
            _0x135e19(_0x7bc3ba.add(7), _0x3212c3.u(_0x24b78c), _0x5a3cf8);
            _0x1c73a7.h(_0x7bc3ba, _0x5a3cf8);
            _0x1c73a7.f(_0x7bc3ba, _0x2759dd.o(_0x28e6f9));
            _0x1c73a7.g(_0x7bc3ba, _0x2759dd.n(_0x28e6f9));
            _0x3202ad(_0x59fc6b.fd, _0x7bc3ba, _0x5a3cf8 + 7, 0);
            _0x453cbe(_0x7bc3ba);
            _0x2759dd.i(_0x28e6f9);
            _0x28e6f9 = _0x8878f.B(_0x59fc6b[_0x1840("0x2c")]);
        }
    }
    _0x59fc6b.pthreadReturn = _0x59fc6b.base[_0x1840("0x1b")](_0x3c6562);
    _0x59fc6b[_0x1840("0x2e")] = Memory.readPointer(_0x59fc6b[_0x1840("0x2b")][_0x1840("0x1b")](_0x11e329));
    _0x59fc6b[_0x1840("0x2f")] = _0x59fc6b.base.add(_0x5f4e4b);
    _0x59fc6b[_0x1840("0x30")] = Memory[_0x1840("0x1e")](_0x59fc6b[_0x1840("0x2e")].add(4));
    _0x59fc6b[_0x1840("0x31")] = Memory.readPointer(_0x59fc6b[_0x1840("0x30")].add(52));
    _0x59fc6b[_0x1840("0x32")] = _0x59fc6b[_0x1840("0x30")].add(60);
    _0x59fc6b[_0x1840("0x2c")] = _0x59fc6b.messaging[_0x1840("0x1b")](84);
    _0x59fc6b[_0x1840("0x33")] = _0x59fc6b.messaging[_0x1840("0x1b")](212);
    _0x59fc6b[_0x1840("0x2d")] = _0x59fc6b[_0x1840("0x30")][_0x1840("0x1b")](216);
    _0x59fc6b[_0x1840("0x34")] = new NativeFunction(_0x59fc6b.base[_0x1840("0x1b")](_0x27aae2), _0x1840("0x5"), [_0x1840("0x6")]);
    _0x59fc6b[_0x1840("0x35")] = new NativeFunction(_0x59fc6b.base[_0x1840("0x1b")](_0x4ed8c8), _0x1840("0x5"), ["pointer", _0x1840("0x6")]);
    Interceptor[_0x1840("0x36")](Module[_0x1840("0x0")](_0x1840("0x3"), _0x1840("0x7")), new NativeCallback(function (_0x28e6f9) {
        if (!this[_0x1840("0x37")][_0x1840("0x38")](_0x59fc6b[_0x1840("0x39")])) {
            return _0x5f2777(_0x28e6f9);
        }
        for (var _0x2024ca = Memory[_0x1840("0x1e")](this[_0x1840("0x3a")].sp[_0x1840("0x1b")](4)), _0x514617 = 0; _0x514617 < _0x59fc6b[_0x1840("0x2a")][_0x1840("0x29")]; _0x514617 += 1) {
            if (_0x2024ca.equals(_0x59fc6b[_0x1840("0x2a")][_0x514617])) {
                return _0x7bc3ba(), 0;
            }
        }
        return _0x5f2777(_0x28e6f9);
    }, _0x1840("0x6"), [_0x1840("0x5")]));
    Interceptor[_0x1840("0x36")](Module[_0x1840("0x0")](_0x1840("0x3"), "select"), new NativeCallback(function (_0x28e6f9, _0x5d8656, _0x49ad76, _0x7bc3ba, _0x4ec5b2) {
        var _0xc5aaa7 = _0x2f71bc(_0x28e6f9, _0x5d8656, _0x49ad76, _0x7bc3ba, _0x4ec5b2);
        return this[_0x1840("0x37")][_0x1840("0x38")](_0x59fc6b.selectReturn) && function () {
            var _0x28e6f9 = _0x59fc6b.newOperator(7);
            _0x5ebcc5(_0x59fc6b.fd, _0x28e6f9, 7, 256);
            var _0x5d8656 = _0x1c73a7.o(_0x28e6f9);
            20104 === _0x5d8656 && Memory[_0x1840("0x1d")](_0x59fc6b[_0x1840("0x33")], 5);
            var _0x49ad76 = _0x1c73a7.m(_0x28e6f9), _0x7bc3ba = _0x1c73a7.y(_0x28e6f9);
            _0x453cbe(_0x28e6f9);
            var _0x4ec5b2 = _0x59fc6b[_0x1840("0x34")](_0x49ad76);
            _0x5ebcc5(_0x59fc6b.fd, _0x4ec5b2, _0x49ad76, 256);
            var _0xc5aaa7 = _0x59fc6b[_0x1840("0x35")](_0x59fc6b.messageFactory, _0x5d8656);
            _0x2759dd.t(_0xc5aaa7, _0x7bc3ba);
            var _0x4b7d6f = _0x2759dd.e(_0xc5aaa7);
            if (_0x3212c3._(_0x4b7d6f, _0x49ad76), _0x49ad76) {
                var _0x5e7b4e = _0x59fc6b.newOperator(_0x49ad76);
                _0x135e19(_0x5e7b4e, _0x4ec5b2, _0x49ad76);
                _0x3212c3.s(_0x4b7d6f, _0x5e7b4e);
            }
            _0x2759dd.r(_0xc5aaa7);
            _0x8878f.w(_0x59fc6b[_0x1840("0x32")], _0xc5aaa7);
            _0x453cbe(_0x4ec5b2);
        }(), _0xc5aaa7;
    }, _0x1840("0x6"), [_0x1840("0x6"), "pointer", _0x1840("0x5"), _0x1840("0x5"), _0x1840("0x5")]));
}
rpc[_0x1840("0x3b")] = {
    init: function (_0x896a04, _0x1ce010) {
        _0x59fc6b[_0x1840("0x26")] = _0x1ce010 || {};
        _0x4499be(_0x1840("0x3c"), function () {
            Interceptor.detachAll();
            _0x59fc6b[_0x1840("0x2b")] = Process[_0x1840("0x3d")](_0x1840("0x3c")).base;
            _0x488c34();
        });
    }
};
